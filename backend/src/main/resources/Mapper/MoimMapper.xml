<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="moim.renew.backend.Moim.Mapper.MoimMapper">

    <!-- ResultMap -->
    <resultMap id="moimResultMap" type="moim.renew.backend.Moim.Entity.MoimEntity">
        <id     property="moimId"       column="Moim_id"/>
        <result property="title"        column="Title"/>
        <result property="isOnline"     column="Is_online"/>
        <result property="maxPeople"    column="Max_people"/>
        <result property="expirationDate" column="Expiration_Date"/>
        <result property="evenDate"     column="Even_Date"/>
        <result property="location"     column="Location"/>
        <result property="representImg" column="Represent_img"/>
        <result property="organizer"    column="Organizer" />
        <result property="description"  column="Description"/>
        <result property="tag" column="Tag" typeHandler="moim.renew.backend.Approval.Handler.StringArrayJsonTypeHandler"/>
        <result property="categoryDetailId" column="CateGoryDetail_id" />
    </resultMap>

    <!-- INSERT -->
    <insert id="InsertMoim" parameterType="moim.renew.backend.Moim.Entity.MoimEntity">
        INSERT INTO moim (
        moim_id, title, is_online, max_people,
        expiration_date, even_date, location,
        represent_img, category,organizer,description, tag,category_detail,approval
        ) VALUES (
        #{moimId}, #{title}, #{isOnline}, #{maxPeople},
        #{expirationDate}, #{evenDate}, #{location},
        #{representImg}, #{category}, #{organizer},
        #{description},#{tag},#{category_detail},#{approval}
        )
    </insert>

    <!-- UPDATE -->
    <update id="UpdateMoim" parameterType="moim.renew.backend.Moim.Entity.MoimEntity">
        UPDATE moim
        SET
        title = #{title},
        is_online = #{isOnline},
        max_people = #{maxPeople},
        expiration_date = #{expirationDate},
        even_date = #{evenDate},
        location = #{location},
        represent_img = #{representImg},
        category = #{category}
        organizer = #{organizer},
        description =  #{description},
        tag = #{tag},
        category_detail = #{category_detail},
        approval = #{approval}
        WHERE moim_id = #{moimId}
    </update>

    <!-- SELECT 단건 -->
    <select id="SelectMoimById" resultMap="moimResultMap" parameterType="string">
        SELECT *
        FROM moim
        WHERE moim_id = #{moimId}
    </select>

    <!-- SELECT 전체 -->
    <select id="SelectAllMoims" resultMap="moimResultMap">
        SELECT *
        FROM moim
    </select>

    <select id="ApprovalByMoimId" resultType="boolean" parameterType="string">
        SELECT approval FROM moim WHERE moim_id = #{moimId}
    </select>

    <!-- DELETE -->
    <delete id="DeleteMoim" parameterType="string">
        DELETE FROM moim
        WHERE moim_id = #{moimId} AND organizer = #{organizer}
    </delete>

</mapper>
